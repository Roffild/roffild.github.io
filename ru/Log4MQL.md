---
title: Log4MQL
---
<p>За основу взяты классы <a target="_blank" href="/go?link=https://www.slf4j.org/apidocs/org/slf4j/Logger.html" rel="nofollow" title="http://www.slf4j.org/apidocs/org/slf4j/Logger.html">Logger</a> и <a target="_blank" href="/go?link=https://www.slf4j.org/apidocs/org/slf4j/helpers/MessageFormatter.html" rel="nofollow" title="http://www.slf4j.org/apidocs/org/slf4j/helpers/MessageFormatter.html">MessageFormatter</a> из библиотеки <a target="_blank" href="/go?link=https://www.slf4j.org/" rel="nofollow" title="http://www.slf4j.org/">SLF4J</a>.</p><p><b>Подключение</b></p><p>Достаточно вставить:</p><pre class="code"><span class="preprocessor">#include </span>&lt;Log4MQL.mqh&gt;</pre>Но для переопределение уровня логирования нужна такая последовательность кода:<pre class="code"><span class="preprocessor">#define </span>_LOG_PARAM
<span class="preprocessor">#include </span>&lt;Log4MQL.mqh&gt;
<span class="keyword">input</span> LOG_LEVEL loglevel = LOG_WARN; <span class="comment">// Log Level</span></pre>А для переопределения класса:<pre class="code"><span class="preprocessor">#define </span>_LOG_CLASS CMyLog
<span class="preprocessor">#include </span>&lt;Log4MQL.mqh&gt;
</pre><p><b>"Юзай макросы, Люк..."</b></p><p>Для обхода синтаксических ограничений MQL5 пришлось использовать макросы.</p><p>Перегрузка макросов по количеству параметров в MQL5 не работает.</p><pre class="code"><span class="preprocessor">#define </span>DEF(a1) <span class="functions">Print</span>(a1)
<span class="preprocessor">#define </span>DEF(a1,a2) <span class="functions">Print</span>(a1,a2) <span class="comment">// WARN: macro redefinition</span>

<span class="keyword">void</span> <span class="functions">OnStart</span>()
{
&nbsp;&nbsp; DEF(<span class="string">"111"</span>); <span class="comment">// ERROR: 'DEF' - not actual parameters count for macro</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'DEF' - undeclared identifier</span>

&nbsp;&nbsp; DEF(<span class="string">"222"</span>, <span class="number">333</span>);
}</pre><p>Для обхода этого ограничения добавлено <b>количество параметров</b> к имени макроса:</p><pre class="code">lgDebug0(<span class="string">"Только текст"</span>);
lgDebug2(<span class="string">"Значения 1={}, 2={}"</span>, <span class="string">"Привет"</span>, <span class="number">100</span>);</pre><p><b>Запись лога в файл</b></p><pre class="code"><span class="preprocessor">#include </span>&lt;Log4MQL_toFile.mqh&gt;</pre><p>Переопределенный класс, который записывает все сообщения в файл.</p><p>Но больше - это тест наследственности классов без изменения принципов использования. <b>///</b> "Нелогичность" реализации некоторых частей класса связана с ограничениями MQL в .<br></p><p><b>Примеры</b></p><p>// тут пример и вывод с обычный</p><p>// тут с файлом</p><p><b>Мониторинг логов</b></p><p>Саму библиотеку можно использовать и просто так, но именно расширяемость парсера <a target="_blank" href="/go?link=http://www.logmx.com/" rel="nofollow" title="http://www.logmx.com/">LogMX</a> подтолкнула меня на создание библиотеки.</p><p><a target="_blank" href="/go?link=http://www.logmx.com/" rel="nofollow" title="http://www.logmx.com/">LogMX</a> создан на <a target="_blank" href="/go?link=https://www.java.com/" rel="nofollow" title="https://www.java.com/">Java</a>, поэтому запускается на многих ОСях.</p><p>Так же <a target="_blank" href="/go?link=http://www.logmx.com/" rel="nofollow" title="http://www.logmx.com/">LogMX</a> поставляется в бесплатной и платной версии. В платной версии можно всю папку логов для мониторинга задать.</p><p>Архив LogMX_Log4MQL.zip (исходник тоже в архиве) нужно распаковать в // тут путь в Линуксе и Вине узнать</p><p>Но вот скирины с настройками <a target="_blank" href="/go?link=http://www.logmx.com/" rel="nofollow" title="http://www.logmx.com/">LogMX</a> для мониторинга логов:<br></p>
